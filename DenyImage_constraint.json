{
  "constraint_name": "custom.blockRedHat9Windows22MarketplaceImages",
  "custom_constraint": {
    "deployment_group": "hcc-ring-internal",
    "condition": "resource.properties.disks.all(d, d.initializeParams.sourceImage.matches('projects/rhel-cloud/global/images/family/rhel-9') || d.initializeParams.sourceImage.matches('projects/windows-cloud/global/images/.*windows-2022.*'))",
    "description": "Restricts the creation of virtual machines using the Red Hat 9 family from the rhel-cloud project and Windows Server 2022 from the windows-cloud project.",
    "display_name": "Public Cloud Platform: Block Red Hat 9 Family and Windows Server 2022 Marketplace Images",
    "action_type": "DENY",
    "method_types": [
      "CREATE",
      "UPDATE"
    ],
    "resource_types": [
      "compute.googleapis.com/Instance"
    ]
  }
}
